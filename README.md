# Currency Catalog Demo

A React Native (Expo) showcase that demonstrates how a reusable `CurrencyListFragment` can serve both crypto and fiat datasets while providing local persistence, search, and demo controls that fill the task requirements for a native activity/fragment flow.

## Highlights
- use [@shopify/flash-list](https://shopify.github.io/flash-list/) as reusable list fragment for performant rendering of large currency datasets.
- MMKV-powered persistence works with Zustand so changing data sources, search input, or empty states always reference a single store.
- Demo header actions emulate the five required buttons: clear storage, insert sample data, switch between list A (crypto), list B (fiat), and show purchasable currencies across both datasets.
- Search bar with debounced queries, close button, and Android back handling to cancel the search gracefully.
- All IO (database simulation via MMKV) is surfaced through async helpers and consumed with React Query to keep work off the UI thread.

## Getting Started
```bash
yarn install
yarn start
```
then run on the platform
```
yarn ios
yarn android
```
The Expo CLI will guide you through opening the app on Android emulator or Xcode Simulator

## Project Structure
```
currency/
├── app.json
├── android                                         # Native android project generated by Expo
├── ios                                             # Native ios project generated by Expo
├── @types                                          # global type definitions
├── assets                                          # expo project legacy images
├── src
│   ├── App.tsx                                     # Entry point
│   ├── components                                  # Shared UI elements (e.g., Button, Skeleton)
│   ├── features
│   │   └── currencyList
│   │       └── components
│   │           ├── CurrencyListFragment.tsx        # Main list fragment
│   │           ├── CurrencyListHeader.tsx          # Header with demo controls
│   │           ├── SearchBar.tsx                   # Search input with debouncing
│   │           ├── CurrencyItem.tsx                # Individual currency row
│   │           └── EmptyView.tsx                   # Empty state view
│   ├── screens                                     # Main screen component (e.g. DemoScreen)
│   ├── hooks                                       # Reusable hooks (e.g., useDebounce)
│   ├── services                                    # services files including MMKV bindings and currency service helpers
│   ├── store                                       # Zustand store for currency UI state
│   ├── theme                                       # Design tokens for spacing, colors, radius etc.
│   └── utils                                       # Constants and list filtering helpers
├── jest.config.js / jest-setup.js                  # Jest configuration
└── package.json                                    # Project scripts and dependencies
```

## Core Modules
- `src/features/currencyList/components/CurrencyListFragment.tsx`  
  Fetches the active dataset (`A`, `B`, or `ALL`) with React Query, filters it via the current search query, and renders the FlashList along with `LoadingSkeleton` and `EmptyView` fallbacks.

- `src/features/currencyList/components/CurrencyListHeader.tsx`  
  Provides the five task-required controls. Each button updates MMKV storage or the Zustand data source so the fragment reacts instantly.

- `src/features/currencyList/components/SearchBar.tsx`  
  Manages search UX with debouncing, cancel/reset behaviour, and Android hardware back interception to exit search without leaving the screen.

- `src/services/currencyService.ts`  
  Simulate database IO through MMKV, exposing async helpers to insert demo data, clear it, and read datasets while filtering purchasable currencies on demand.

- `src/store/useCurrencyStore.ts`  
  Centralizes list state (selected dataset, query string, filtered results) so multiple components and screens stay in sync.

- `src/utils/constants.ts` & `src/utils/filter.ts`  
  Host sample data for lists A/B and the pure utility logic used to derive purchasable entries and search results.

## Demo Flow
1. Tap **Insert** to seed MMKV with the crypto (List A) and fiat (List B) samples.  
2. Use **Crypto** or **Fiat** to toggle which dataset the fragment displays.  
3. Tap **Purchasable** to merge both lists and show only currencies marked as `canPurchase`.  
4. Use the search field to filter results; the cancel button or Android back exits search.  
5. Tap **Clear** to remove all persisted data and reset the list to an empty state(because of react-query cache, you need to switch datasource to update the change).

## Testing
- `yarn test` runs the Jest suite (configured with `jest.config.js` and `jest-setup.js`).

## Tech Stack
- Expo + React Native
- Zustand + MMKV for persistent client-side state
- @tanstack/react-query for async orchestration
- @shopify/flash-list for performant lists
- TypeScript across the codebase for type safety
- Jest + React Native Testing Library for unit tests
